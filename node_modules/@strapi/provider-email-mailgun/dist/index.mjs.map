{"version":3,"file":"index.mjs","sources":["../src/index.ts"],"sourcesContent":["import assert from 'node:assert';\nimport formData from 'form-data';\nimport Mailgun, { type MailgunClientOptions } from 'mailgun.js';\n\ninterface Settings {\n  defaultFrom: string;\n  defaultReplyTo: string;\n}\n\ninterface SendOptions {\n  from?: string;\n  to: string;\n  cc: string;\n  bcc: string;\n  replyTo?: string;\n  subject: string;\n  text: string;\n  html: string;\n  [key: string]: unknown;\n}\n\ntype ProviderOptions = MailgunClientOptions & {\n  domain: string;\n};\n\nconst DEFAULT_OPTIONS = {\n  username: 'api',\n};\n\nexport default {\n  init(providerOptions: ProviderOptions, settings: Settings) {\n    assert(providerOptions.key, 'Mailgun API key is required');\n    assert(providerOptions.domain, 'Mailgun domain is required');\n\n    const mailgun = new Mailgun(formData);\n    const mg = mailgun.client({\n      ...DEFAULT_OPTIONS,\n      ...providerOptions,\n    });\n\n    return {\n      send(options: SendOptions) {\n        const { from, to, cc, bcc, replyTo, subject, text, html, ...rest } = options;\n\n        const data = {\n          from: from || settings.defaultFrom,\n          to,\n          cc,\n          bcc,\n          'h:Reply-To': replyTo || settings.defaultReplyTo,\n          subject,\n          text,\n          html,\n          ...rest,\n        };\n\n        return mg.messages.create(providerOptions.domain as string, data);\n      },\n    };\n  },\n};\n"],"names":[],"mappings":";;;AAyBA,MAAM,kBAAkB;AAAA,EACtB,UAAU;AACZ;AAEA,MAAe,QAAA;AAAA,EACb,KAAK,iBAAkC,UAAoB;AAClD,WAAA,gBAAgB,KAAK,6BAA6B;AAClD,WAAA,gBAAgB,QAAQ,4BAA4B;AAErD,UAAA,UAAU,IAAI,QAAQ,QAAQ;AAC9B,UAAA,KAAK,QAAQ,OAAO;AAAA,MACxB,GAAG;AAAA,MACH,GAAG;AAAA,IAAA,CACJ;AAEM,WAAA;AAAA,MACL,KAAK,SAAsB;AACnB,cAAA,EAAE,MAAM,IAAI,IAAI,KAAK,SAAS,SAAS,MAAM,MAAM,GAAG,KAAA,IAAS;AAErE,cAAM,OAAO;AAAA,UACX,MAAM,QAAQ,SAAS;AAAA,UACvB;AAAA,UACA;AAAA,UACA;AAAA,UACA,cAAc,WAAW,SAAS;AAAA,UAClC;AAAA,UACA;AAAA,UACA;AAAA,UACA,GAAG;AAAA,QAAA;AAGL,eAAO,GAAG,SAAS,OAAO,gBAAgB,QAAkB,IAAI;AAAA,MAClE;AAAA,IAAA;AAAA,EAEJ;AACF;"}